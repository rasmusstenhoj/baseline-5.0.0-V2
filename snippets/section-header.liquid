{% liquid
  assign show_view_all = false

  if link_text != '' and link_url != ''
    if settings.section_title_align == 'left' and show_link
      assign show_view_all = true
    elsif has_view_all_button_top
      assign show_view_all = true
    endif
  endif

  assign heading_width_class = ''
  if settings.section_title_align == 'left'
    if settings.desktop_standard_heading_scale > 3 and show_view_all == true
      assign heading_width_class = 'xl:basis-4/5'
    endif
  endif
%}
<div
  class="{% unless hide_bottom_border %}border-b-gridline{% endunless %} border-gridline-color bg-scheme-background px-section-horizontal-spacing pb-theme pt-theme-double text-scheme-text {% if settings.section_title_align == 'left' %}lg:flex gap-4 items-end justify-between lg:[align-items:last_baseline]{% else %}text-center{% endif %}"
  data-color-scheme="{{ section_color }}"
>
  <div class="flex flex-col gap-2 {% if settings.section_title_align == 'center' %}items-center{% endif %}">
    {%- if title != blank and subheading != blank -%}
      <span class="font-subheading text-subheading {% render 'subheading-symbol-classes' %} {% if settings.double_subheading_spacing %}mb-2{% endif %}">
        {{ subheading | strip }}
      </span>
    {%- endif -%}

    <h2 class="{{ settings.section_title_font }} text-heading-standard {{ heading_width_class }} break-word">
      {% if show_collection_count %}
        <span>{{- title -}}</span>
        <sup
          class="-ml-inline-sup"
        >
          {% if products_count %}
            {{- products_count -}}
            <span class="sr-only">
              {{- 'general.search.products' | t -}}
            </span>
          {% else %}
            {% comment %} show placeholder if no collection is selected {% endcomment %}
            3
          {% endif %}
        </sup>
      {% else %}
        {{- title -}}
      {% endif %}
    </h2>
  </div>

  {%- if show_view_all -%}
    <div class="mt-cta {% unless has_view_all_button_top %}lg:mt-0{% endunless %} lg:shrink-0 {% if settings.section_title_align == 'left' %}lg:text-right{% endif %}">
      <a
        class="theme-link inline-block text-scheme-text hover:text-scheme-accent"
        href="{{ link_url }}"
      >
        {{- link_text -}}
      </a>
    </div>
  {%- endif -%}
</div>
