{% liquid
  unless loading
    assign loading = null
  endunless

  unless preload
    assign preload = false
  endunless

  if image_mobile != blank
    assign desktop_preload = false
  else
    assign desktop_preload = preload
  endif

  unless is_deep_inset
    assign is_deep_inset = false
  endunless

  if is_deep_inset
    assign media_padding_class = 'p-deep-inset-media'
  else
    assign media_padding_class = 'p-grid-media'
  endif

  unless has_newsletter
    assign has_newsletter = false
  endunless
%}

<div
  class="bg-scheme-background{% unless no_border %} border-b-gridline border-gridline-color{% endunless %} group relative overflow-hidden {{ size_classes }} {% if cta_link != blank %}group/zoom{% endif %}"
  data-color-scheme="{{ section_color_scheme }}"
>
  {% if cta_link != blank %}
    {% unless has_countdown_timer and has_newsletter %}
      <a href="{{ cta_link }}" class="focus-inset absolute inset-0 z-11"
        ><span class="sr-only">
          {%- if cta_text != blank -%}
            {{- cta_text -}}
          {%- elsif image and image.alt != blank -%}
            {{- image.alt -}}
          {%- endif -%}
        </span></a
      >
    {% endunless %}
  {% endif %}
  <div
    class="h-full w-full text-scheme-text {{ media_padding_class }}{% unless scheme_text_color_only %} bg-scheme-background{% endunless %}"
    data-color-scheme="{{ color_scheme }}"
  >
    <div class="relative h-full w-full">
      {% if image != blank %}
        <div
          {% if image_mobile != blank %}
            class="hidden lg:block"
          {% endif %}
        >
          {% render 'image-fill',
            image: image,
            loading: loading,
            preload: desktop_preload,
            is_deep_inset: is_deep_inset
          %}
        </div>

        {% if image_mobile != blank %}
          <div class="lg:hidden">
            {% assign image = image_mobile %}
            {% render 'image-fill',
              image: image,
              loading: loading,
              preload: preload,
              is_deep_inset: is_deep_inset
            %}
          </div>
        {% endif %}
      {% else %}
        {%- render 'image-fill-placeholder',
          is_deep_inset: deep_inset,
          type: 'lifestyle-1'
        -%}
      {% endif %}
    </div>
  </div>

  <div
    class="group absolute bottom-0 left-0 right-0 top-0 z-10 p-media-content"
    data-color-scheme="{{ color_scheme }}"
  >
    <div class="flex h-full w-full {{ content_position }}">
      <div
        class="{{ content_width_desktop }} text-scheme-text{% if has_countdown_timer %} max-lg:w-full{% endif %}"
      >
        {% render 'section-content',
          title: title,
          title_size_class: heading_size_class,
          subheading: subheading
        %}

        {% if has_countdown_timer %}
          <div class="mt-4">
            {% render 'countdown-timer',
              sr_title: sr_title,
              year: year,
              month: month,
              day: day,
              hour: hour,
              minute: minute,
              font: font,
              style: style,
              number_padding: number_padding,
              flash_separators: flash_separators,
              minimum_shown_parts: minimum_shown_parts,
              metafield_ns_and_key: metafield_ns_and_key,
              no_background: true
            %}
          </div>
        {% endif %}

        {% if text != blank %}
          <div class="rte mt-4 text-base">
            {{ text }}
          </div>
        {% endif %}

        {% if cta_link != blank and cta_text != '' %}
          {% unless has_countdown_timer and has_newsletter %}
            <div class="mt-cta text-0">
              {%- case cta_style -%}
                {%- when 'link' -%}
                  <span
                    class="theme-link inline-block text-scheme-text group-hover:text-scheme-accent"
                  >
                    {{- cta_text -}}
                  </span>
                {%- when 'button' -%}
                  <span
                    class="theme-button {% if cta_button_style == 'secondary' %}theme-button--secondary{% endif %} theme-button--in-group inline-block"
                  >
                    {{- cta_text -}}
                  </span>
              {%- endcase -%}
            </div>
          {% endunless %}
        {% endif %}

        {% if has_newsletter %}
          <div class="mt-4 lg:flex {% if content_position contains 'text-left' %}lg:justify-start{% elsif content_position contains 'text-center' %}lg:justify-center{% else %}lg:justify-end{% endif %}">
            <div class="w-full xl:max-w-3/5">
              {% render 'newsletter-form', form_id: form_id %}
            </div>
          </div>
        {% endif %}
      </div>
    </div>
  </div>
</div>
