<div
  id="filters-form-sort-drop-down"
  data-fragment-id="filters-form-sort-drop-down"
  class="ml-auto"
>
  <div
    data-filterable-filter-fragment="sort-drop-down"
  >
    <div
      class="flex items-center self-start"
    >
      <button
        type="button"
        id="sort-drop-down-toggle"
        x-ref="sortDropDownToggle"
        class="flex items-center py-2 hover:text-scheme-accent {% if settings.nav_uppercase %}uppercase{% endif %}"
        x-bind:aria-expanded="sortOpen ? true : 'false'"
        @click="sortOpen = ! sortOpen"
        aria-controls="sort-drop-down"
      >
        {{ 'collections.sorting.title' | t }}
        {%- if settings.accordion_icon == 'caret' -%}
          <span
            class="rotate ml-1 inline-block h-3 w-3 origin-center transform align-middle transition"
            :class="{ 'rotate-180' : sortOpen }"
          >
            {%- render 'icon-chevron-down' -%}
          </span>
        {%- else -%}
          <span
            class="ml-1 inline-block h-3 w-3 origin-center align-middle"
            x-show="!sortOpen"
          >
            {%- render 'icon-plus' -%}
          </span>
          <span
            class="ml-1 inline-block h-3 w-3 origin-center align-middle"
            x-show="sortOpen"
            style="display: none;"
          >
            {%- render 'icon-minus' -%}
          </span>
        {%- endif -%}
      </button>
      <div
        id="sort-drop-down"
        class="absolute bottom-auto left-0 top-full z-35 w-full border-y-gridline border-gridline-color bg-scheme-background py-section-vertical-spacing text-scheme-text"
        x-show="sortOpen"
        x-cloak
        x-transition:enter="transition ease duration-200"
        x-transition:enter-start="opacity-0"
        x-transition:enter-end="opacity-100"
        x-transition:leave="transition ease duration-200"
        x-transition:leave-start="opacity-100"
        x-transition:leave-end="opacity-0"
        data-filterable-dropdown
        @focusout="focusOut($event, 'sortOpen')"
        @click.outside="clickOutside($event, 'sortOpen', false)"
      >
        <div
          class="sort-wrapper flex justify-end px-section-horizontal-spacing"
          :class="{ 'opacity-50' : loading }"
        >
          <div class="js-filter" data-index="sort">
            <div class="block{% if filters_layout_on_desktop == 'drop_down' %} md:hidden{% endif %}">
              {%- render 'filterable-sort-options',
                sort_options: sort_options,
                sort_by: sort_by,
                form_id: 'filters-form-drawer',
                show_filters: show_filters,
                is_search: is_search,
                search_terms: search_terms
              -%}
            </div>

            {%- if filters_layout_on_desktop == 'drop_down' -%}
              <div class="hidden md:block">
                {%- render 'filterable-sort-options',
                  sort_options: sort_options,
                  sort_by: sort_by,
                  form_id: 'filters-form-filters-drop-down',
                  context: 'desktop',
                  show_filters: show_filters,
                  is_search: is_search,
                  search_terms: search_terms
                -%}
              </div>
            {% endif %}
            <span class="inline-block" aria-hidden="true">&nbsp;</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
